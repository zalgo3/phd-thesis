\documentclass[../main]{subfiles}

\begin{document}
\section{Convergence rates analysis} \zlabel{sec:acc_pgm:rate}
This section shows that \zcref{alg:acc_pgm_MO} has the~$O(1 / k^2)$ convergence rate under \zcref{asm:pgm_Lipschitz_gradient}.
For simplicity, we suppose the constant stepsize~$\alpha \in (0, 1 / L_f]$.
Then, \zcref{thm:nondecreasing,thm:descent} implies
\begin{equation} \label{eq:acc_pgm_sdc}
    \theta^\acc_\alpha(x, y) \ge \max_{i = 1, \dots, m}\left[ F_i(p^\acc_\alpha(x, y)) - F_i(x) \right]
\end{equation}
for all~$x \in \dom(F)$ and~$y \in \setR^n$.
When it is challenging to estimate~$L_f$, we can use the backtracking procedure like \zcref{sec:pgm:algorithm:sdc}.

We present below the main theorem of this section.
\begin{theorem} \zlabel{thm:acc_pgm_rate}
    Let~$\set*{x^k}$ be a sequence generated by \zcref{alg:acc_pgm_MO} and recall that~$u_\infty$ is given by~\zcref{eq:gap_MO}.
    Then, the following two equations hold:
    \begin{enumerate}
    \item $F_i\left(x^k\right) \le F_i(x^0)$ for all~$i = 1, \dots, m$ and~$k \ge 0$; \zlabel{thm:acc_pgm_rate:less than x0}
    \item $u_\infty\left(x^k\right) = O(1 / k^2)$ as $k \to \infty$ under \zcref{asm:bound}. \zlabel{thm:main theomrem of stepsize section:O(1/k2)}
    \end{enumerate}
\end{theorem}
\zcref[S]{thm:acc_pgm_rate:less than x0} means that~$\set*{x^k} \subseteq \level_F(F(x^0))$, where~$\level_{F(x^0)}(F)$ denotes the level set of~$F$ (cf.~\zcref{eq:level}).
Note, however, that the objective functions are generally not monotonically non-increasing.
\zcref[S]{thm:main theomrem of stepsize section:O(1/k2)} also claims the global convergence rate.

Before proving \zcref{thm:acc_pgm_rate}, let us give several lemmas.
First, we present some properties of~$\set{t_k}$ and~$\set{\gamma_k}$.
As in~\cite{Tanabe2022a}, we also introduce~$\sigma_k \colon \setR^n \to [-\infty, +\infty)$ and~$\rho_k \colon \setR^n \to \setR$ for~$k \ge 0$ as follows, which assist the analysis:
\begin{equation} \label{eq:sigma rho}
\begin{gathered} 
    \sigma_k(z) \coloneqq \min_{i = 1, \dots, m} \left[ F_i\left(x^k\right) - F_i(z) \right], \\
        \rho_k(z) \coloneqq \norm*{t_{k + 1} x^{k + 1} - (t_{k + 1} - 1) x^k - z}_2^2
.\end{gathered}
\end{equation}
The following lemma on~$\sigma_k$ is helpful in the subsequent discussions.
\begin{lemma} \zlabel{thm:acc_pgm_fdiff}
    Let~$\set*{x^k}$ and~$\set*{y^k}$ be sequences generated by \zcref{alg:acc_pgm_MO}.
    Then, the following inequalities hold for all~$z \in \setR^n$ and~$k \ge 0$:
    \begin{enumerate}
        \item \zlabel{thm:acc_pgm_fdiff:cur_opt} $\displaystyle \sigma_{k + 1}(z) \le - \frac{1}{\alpha} \innerp*{y^{k + 1} - x^{k + 1}}{z - y^{k + 1}} - \frac{1}{2 \alpha} \norm*{x^{k + 1} - y^{k + 1}}_2^2$;
        \item \zlabel{thm:acc_pgm_fdiff:cur_prev} $\displaystyle \sigma_{k + 1}(z) - \sigma_k(z) \le \max_{i = 1, \dots, m} \left[ F_i\left(x^{k + 1}\right) - F_i\left( x^k \right) \right] \le - \frac{1}{\alpha} \innerp*{y^{k + 1} - x^{k + 1}}{x^k - y^{k + 1}} - \frac{1}{2 \alpha} \norm*{x^{k + 1} - y^{k + 1}}_2^2$.
    \end{enumerate}
\end{lemma}
\begin{proof}
    Suppose that~$z \in \setR^n$ and~$k \ge 0$.
    Recall that a Lagrange multiplier~$\lambda\left( x^k, y^{k + 1} \right) \in \simplex^m$ exists and satisfies the optimality condition~\zcref{eq:acc_pgm_opt}.
    
    \zcref[S]{thm:acc_pgm_fdiff:cur_opt}:
    From the definition~\zcref{eq:sigma rho} of~$\sigma_{k + 1}$, we get
    \begin{align}
        \sigma_{k + 1}(z) &= \min_{i = 1, \dots, m} \left[ F_i\left(x^{k + 1}\right) - F_i(z) \right] \\
                          &\le \sum_{i = 1}^m \lambda_i\left( x^k, y^{k + 1} \right) \left[ F_i\left(x^{k + 1}\right) - F_i(z) \right] \\
                          &= \sum_{i = 1}^{m} \lambda_i\left( x^k, y^{k + 1} \right) \left[ F_i\left(x^{k + 1}\right) - F_i\left( x^k \right) + F_i\left( x^k \right) - F_i(z) \right]
    .\end{align}
    where the inequality follows from~$\lambda\left( x^k, y^{k + 1} \right) \in \simplex^m$.
    From~\zcref{eq:acc_pgm_sdc}, we have
    \begin{align}
        \MoveEqLeft[1.5] \sigma_{k + 1}(z) \le \theta^\acc_\alpha\left( x^k, y^{k + 1} \right) + \sum_{i = 1}^{m} \lambda_i\left( x^k, y^{k + 1} \right) \left[ F_i\left( x^k \right) - F_i(z) \right] \\
        ={}& \sum_{i = 1}^{m} \lambda_i\left( x^k, y^{k + 1} \right) \left[ \innerp*{\nabla f_i\left( y^{k + 1} \right) }{x^{k + 1} - y^{k + 1}} + g_i\left( x^{k + 1} \right) + f_i\left( y^{k + 1} \right) - F_i(z) \right] \\
           &+ \frac{1}{2 \alpha} \norm*{x^{k + 1} - y^{k + 1}}_2^2
    ,\end{align}
    where the second inequality comes from~\zcref{eq:acc_pgm_active,eq:acc_pgm_optimal_function}.
    The convexity of~$f_i$ yields
    \begin{multline}
        \sigma_{k + 1}(z) \\
        \le \sum_{i = 1}^{m} \lambda_i\left( x^k, y^{k + 1} \right) \left[ \innerp*{\nabla f_i\left( y^{k + 1} \right) }{x^{k + 1} - z} + g_i\left( x^{k + 1} \right) - g_i(z) \right] + \frac{1}{2 \alpha} \norm*{x^{k + 1} - y^{k + 1}}_2^2
    .\end{multline}
    \zcref[S]{eq:acc_pgm_opt} gives
    \begin{align}
        \sigma_{k + 1}(z) &\le - \frac{1}{\alpha} \innerp*{y^{k + 1} - x^{k + 1}}{z - x^{k + 1}} + \frac{1}{2 \alpha} \norm*{x^{k + 1} - y^{k + 1}}_2^2 \\
                          &= - \frac{1}{\alpha} \innerp*{y^{k + 1} - x^{k + 1}}{z - y^{k + 1}} - \frac{1}{2 \alpha} \norm*{x^{k + 1} - y^{k + 1}}_2^2
    .\end{align}

    \zcref[S]{thm:acc_pgm_fdiff:cur_prev}:
    Again, from the definition~\zcref{eq:sigma rho} of~$\sigma_k$, we obtain
    \begin{align}
            \MoveEqLeft \sigma_{k + 1}(z) - \sigma_k(z) \\
            &=  \min_{i = 1, \dots, m}\left[ F_i\left(x^{k + 1}\right) - F_i(z) \right] - \min_{i = 1, \dots, m}\left[ F_i\left(x^k\right) - F_i(z) \right]  \\
        &\le \max_{i = 1, \dots, m}\left[ F_i\left(x^{k + 1}\right) - F_i\left(x^k\right) \right]
    ,\end{align} 
    where the inequality holds because of~\zcref{eq:min_diff_ineq}.
    \zcref[S]{eq:acc_pgm_sdc} leads to
    \begin{align}
        \MoveEqLeft[1] \max_{i = 1, \dots, m} \left[ F_i\left( x^{k + 1} \right) - F_i\left( x^k \right) \right] \le \theta^\acc_\alpha\left( x^k, y^{k + 1} \right) \\
        ={}& \sum_{i = 1}^{m} \lambda_i\left( x^k, y^{k + 1} \right) \left[ \innerp*{\nabla f_i(y^{k + 1})}{x^{k + 1} - y^{k + 1}} + g_i\left( x^{k + 1} \right) + f_i\left( y^{k + 1} \right) - F_i\left( x^k \right) \right] \\
        &+ \frac{1}{2 \alpha} \norm*{x^{k + 1} - y^{k + 1}}_2^2
    \end{align}
    where the equality is from~\zcref{eq:acc_pgm_active,eq:acc_pgm_optimal_function}.
    From the convexity of~$f_i$, we obtain
    \begin{align}
        \MoveEqLeft  \max_{i = 1, \dots, m} \left[ F_i\left( x^{k + 1} \right) - F_i\left( x^k \right) \right] \\
        \le{}& \sum_{i = 1}^{m} \lambda_i\left( x^k, y^{k + 1} \right) \left[ \innerp*{\nabla f_i(y^{k + 1})}{x^{k + 1} - x^k} + g_i\left( x^{k + 1} \right) - g_i\left( x^k \right) \right] \\
        &+ \frac{1}{2 \alpha} \norm*{x^{k + 1} - y^{k + 1}}_2^2
    .\end{align}
    \zcref[S]{eq:acc_pgm_opt} yields
    \begin{align}
        \max_{i = 1, \dots, m} \left[ F_i\left( x^{k + 1} \right) - F_i\left( x^k \right) \right] 
        &\le - \frac{1}{\alpha} \innerp*{y^{k + 1} - x^{k + 1}}{x^k - x^{k + 1}} + \frac{1}{2 \alpha} \norm*{x^{k + 1} - y^{k + 1}}_2^2 \\
        &= - \frac{1}{\alpha} \innerp*{y^{k + 1} - x^{k + 1}}{x^k - y^{k + 1}} - \frac{1}{2 \alpha} \norm*{x^{k + 1} - y^{k + 1}}_2^2
    .\end{align}
\end{proof}

Therefore, from \zcref{thm:mom_fac:fac2_le1}, we can obtain the following result quickly in the same way as in the proof of~\cite[Corollary 5.1]{Tanabe2022a}.
\begin{lemma} \zlabel{thm:acc_pgm_fdiff_sep}
    Let~$\set*{x^k}$ and~$\set*{y^k}$ be sequences generated by \zcref{alg:acc_pgm_MO}.
    Then, we have
    \begin{multline}
        \sigma_{k_2}(z) - \sigma_{k_1}(z) \le \max_{i = 1, \dots, m} \left[ F_i\left(x^{k_2}\right) - F_i\left( x^{k_1} \right)  \right] \\
        \le - \frac{1}{2 \alpha} \left( \norm*{x^{k_2} - x^{k_2 - 1}}_2^2 - \norm*{x^{k_1} - x^{k_1 - 1}}_2^2 + \sum_{k = k_1}^{k_2 - 1} \frac{1}{t_k} \norm*{x^k - x^{k - 1}}_2^2 \right)
    \end{multline}
    for any~$k_2 \ge k_1 \ge 1$.
\end{lemma}
\begin{proof}
    Let~$k \ge 1$.
    From \zcref{thm:acc_pgm_fdiff:cur_prev} is equivalent to
    \begin{align}
        \sigma_{k + 1}(z) - \sigma_k(z) \le \max_{i = 1, \dots, m} \left[ F_i\left(x^{k + 1}\right) - F_i\left( x^k \right) \right]  &\le - \frac{1}{2 \alpha} \left( \norm*{x^{k + 1} - x^k}_2^2 - \norm*{y^{k + 1} - x^k}_2^2 \right) \\
                                        &= - \frac{1}{2 \alpha} \left( \norm*{x^{k + 1} - x^k}_2^2 - \gamma_k^2 \norm*{x^k - x^{k - 1}}_2^2 \right)
    ,\end{align}
    where the equality comes from \zcref{alg:acc_pgm_MO:seq2} of \zcref{alg:acc_pgm_MO}.
    Adding up this inequality from~$k = k_1$ to~$k = k_2 - 1$ yields
    \begin{align}
        \MoveEqLeft \sigma_{k_2}(z) - \sigma_{k_1}(z) \le \max_{i = 1, \dots, m} \left[ F_i\left( x^{k_2} \right) - F_i\left( x^{k_1} \right)  \right] \\
        &\le - \frac{1}{2 \alpha} \left[ \norm*{x^{k_2} - x^{k_2 - 1}}_2^2 - \norm*{x^{k_1} - x^{k_1 - 1}}_2^2 + \sum_{k = k_1}^{k_2 - 1} \left( 1 - \gamma_k^2 \right) \norm*{x^k - x^{k - 1}}_2^2 \right] 
    .\end{align}
    Using \zcref{thm:mom_fac:fac2_le1}, we get the desired inequality.
\end{proof}

We can now show the first part of \zcref{thm:acc_pgm_rate}.
\begin{proof}[Proof of \zcref{thm:acc_pgm_rate:less than x0}]
    It is clear from \zcref{thm:acc_pgm_fdiff_sep} with~$k_1 = 0$ and~$k_2 = k$.
\end{proof}

The next step is to prepare the proof of \zcref{thm:main theomrem of stepsize section:O(1/k2)}.
\begin{lemma} \zlabel{thm:key relation}
    Let~$\set*{x^k}$ and~$\set*{y^k}$ be sequences generated by \zcref{alg:acc_pgm_MO}.
    Also, let~$\sigma_k$ and~$\rho_k$ be defined by~\zcref{eq:sigma rho}.
    Then, we have
    \begin{multline}
        \frac{1}{1 - a} \left[ t_{k + 1}^2 - a t_{k + 1} + \left( \frac{1}{4} - b \right) k \right] \sigma_{k + 1}(z) \\
        + \frac{1}{2 \alpha (1 - a)} \left[ a (t_{k + 1}^2 - t_{k + 1}) + \left( \frac{1}{4} - b \right) k \right] \norm*{x^{k + 1} - x^k}_2^2 \\
        + \frac{1}{2 \alpha (1 - a)} \sum_{p = 1}^{k} \left[ a^2 (t_p - 1) + \left( \frac{1}{4} - b \right) \frac{p - t_p + a(t_p - 1)}{t_p} \right] \norm*{x^p - x^{p - 1}}_2^2 \\
        + \frac{1}{2 \alpha} \rho_k(z)
        \le \frac{1}{2 \alpha} \norm*{x^0 - z}_2^2
    .\end{multline}
    for all~$k \ge 0$ and~$z \in \setR^n$.
\end{lemma}
\begin{proof}
    Let~$p \ge 1$ and~$z \in \setR^n$.
    Adding \zcref{thm:acc_pgm_fdiff:cur_prev} multiplied by~$(t_{p + 1} - 1)$ and~\zcref{thm:acc_pgm_fdiff:cur_opt}, both with~$k = p$, yields
    \begin{multline}
        t_{p + 1} \sigma_{p + 1}(z) - (t_{p + 1} - 1) \sigma_p(z) \\
        \le - \frac{1}{2 \alpha} \left[ t_{p + 1} \norm*{x^{p + 1} - y^{p + 1}}_2^2 + 2 \innerp*{x^{p + 1} - y^{p + 1}}{t_{p + 1} y^{p + 1} - (t_{p + 1} - 1)x^p - z} \right]
    .\end{multline}
    Multiplying this inequality by~$t_{p + 1}$ and using the relation~$t_p^2 = t_{p + 1}^2 - t_{p + 1} + (a t_p - b + 1/4)$ (cf. \zcref{thm:mom_fac:gratio}), we get
    \begin{multline}
        t_{p + 1}^2 \sigma_{p + 1}(z) - t_p^2 \sigma_p(z) \le - \frac{1}{2 \alpha} \Bigl[ \norm*{t_{p + 1} (x^{p + 1} - y^{p + 1})}_2^2  \\
        + 2 t_{p + 1} \innerp*{x^{p + 1} - y^{p + 1}}{t_{p + 1} y^{p + 1} - (t_{p + 1} - 1)x^p - z} \Bigr] - \left( a t_p - b + \frac{1}{4} \right) \sigma_p(z)
    .\end{multline}
    Applying~\zcref{eq:Pythagoras} to the right-hand side of the above inequality with
    \begin{equation}
        v^1 \coloneqq t_{p + 1} y^{p + 1}, \quad v^2 \coloneqq t_{p + 1} x^{p + 1}, \quad v^3 \coloneqq (t_{p + 1} - 1) x^p + z
    ,\end{equation}
    we get
    \begin{multline}
        t_{p + 1}^2 \sigma_{p + 1}(z) - t_p^2 \sigma_p(z) \\
        \le - \frac{1}{2 \alpha} \left[ \norm*{t_{p + 1} x^{p + 1} - (t_{p + 1} - 1) x^p - z}_2^2 - \norm*{t_{p + 1} y^{p + 1} - (t_{p + 1} - 1) x^p - z}_2^2 \right] \\
        - \left( a t_p - b + \frac{1}{4} \right) \sigma_p(z)
    .\end{multline}
    Recall that~$\rho_p(z) \coloneqq \norm*{t_{p + 1} x^{p + 1} - (t_{p + 1} - 1) x^p - z}_2^2$.
    Then, considering the definition of~$y^p$ given in \zcref{alg:acc_pgm_MO:seq2} of \zcref{alg:acc_pgm_MO}, we obtain
    \begin{equation}
        t_{p + 1}^2 \sigma_{p + 1}(z) - t_p^2 \sigma_p(z) \le - \frac{1}{2 \alpha} \left[ \rho_p(z) - \rho_{p - 1}(z) \right] - \left( a t_p - b + \frac{1}{4} \right) \sigma_p(z)
    .\end{equation}
    Now, let~$k \ge 0$.
    \zcref{thm:acc_pgm_fdiff_sep} with~$(k_1, k_2) = (p, k + 1)$ implies
    \begin{multline}
        t_{p + 1}^2 \sigma_{p + 1}(z) - t_p^2 \sigma_p(z) \le - \frac{1}{2 \alpha} \left[ \rho_p(z) - \rho_{p - 1}(z) \right] \\
        - \left( a t_p - b + \frac{1}{4} \right) \Biggl[ \sigma_{k + 1}(z) + \frac{1}{2 \alpha} \left( \norm*{x^{k + 1} - x^k}_2^2 - \norm*{x^p - x^{p - 1}}_2^2 + \sum_{r = p}^k \frac{1}{t_r} \norm*{x^r - x^{r - 1}}_2^2 \right) \Biggr]
    .\end{multline}
    Adding up the above inequality from~$p = 1$ to~$p = k$, the fact that~$t_1 = 1$ and~$\rho_0(z) = \norm*{x^1 - z}_2^2$ leads to
    \begin{multline} \label{eq:key relation tmp}
        t_{k + 1}^2 \sigma_{k + 1}(z) - \sigma_1(z) \le - \frac{1}{2 \alpha} \left[ \rho_{k}(z) - \norm*{x^1 - z}_2^2 \right] \\
        - \left( a \sum_{p = 1}^{k} t_p + \left( \frac{1}{4} - b \right) k \right) \left[ \sigma_{k + 1}(z) + \frac{1}{2 \alpha} \norm*{x^{k + 1} - x^k}_2^2 \right] \\
        + \frac{1}{2 \alpha} \sum_{p = 1}^{k} \left( a t_p - b + \frac{1}{4} \right) \norm*{x^p - x^{p + 1}}_2^2 \\
        - \frac{1}{2 \alpha} \sum_{p = 1}^{k} \left( a t_p - b + \frac{1}{4} \right) \sum_{r = p}^{k} \frac{1}{t_r} \norm*{x^r - x^{r - 1}}_2^2 
    .\end{multline}
    Let us write the last two terms of the right-hand side for~\zcref{eq:key relation tmp} as~$S_1$ and~$S_2$, respectively.
    \zcref{eq:change sum} yields
    \begin{align}
            S_2 &= - \frac{1}{2 \alpha} \sum_{r = 1}^{k} \sum_{p = 1}^{r} \left( a t_p - b + \frac{1}{4} \right) \frac{1}{t_r} \norm*{x^r - x^{r - 1}}_2^2 \\
                &= - \frac{1}{2 \alpha} \sum_{p = 1}^{k} \sum_{r = 1}^{p} \left( a t_r - b + \frac{1}{4} \right) \frac{1}{t_p} \norm*{x^p - x^{p - 1}}_2^2
    .\end{align}
    Hence, it follows that
    \begin{multline} \label{eq:s_1 + s_2}
         S_1 + S_2 = - \frac{1}{2 \alpha} \sum_{p = 1}^{k} \left[ \frac{1}{t_p} \sum_{r = 1}^{p} \left( a t_r - b + \frac{1}{4} \right) - \left( a t_p - b + \frac{1}{4} \right) \right] \norm*{x^p - x^{p - 1}}_2^2 \\
         = - \frac{1}{2 \alpha} \sum_{p = 1}^{k} \frac{1}{t_p} \left[ a \left( \sum_{r = 1}^{p - 1} t_r - t_p^2 + t_p \right) + \left( \frac{1}{4} - b \right) (p - t_p) \right] \norm*{x^p - x^{p - 1}}_2^2
    .\end{multline}
    Again~$t_1 = 1$ gives
    \begin{align}
            - t_p^2 + t_p &= \sum_{r = 1}^{p - 1} ( - t_{r + 1}^2 + t_{r + 1} + t_r^2 - t_r ) = \sum_{r = 1}^{p - 1} \left(- (1 - a) t_r - b + \frac{1}{4} \right) \\
                          &= - (1 - a) \sum_{r = 1}^{p - 1} t_r + \left( \frac{1}{4} - b \right) (p - 1)
    ,\end{align}
    where the second equality comes from \zcref{thm:mom_fac:gratio}.
    Thus, we get
    \begin{equation} \label{eq:sum t}
        \sum_{r = 1}^{p - 1} t_r = \frac{t_p^2 - t_p}{1 - a} + \left( \frac{1}{4} - b \right) \frac{p - 1}{1 - a}
    .\end{equation} 
    Substituting this into~\zcref{eq:s_1 + s_2}, it follows that
    \begin{multline}
        S_1 + S_2 = - \frac{1}{2 \alpha (1 - a)} \sum_{p = 1}^{k} \left[ a^2 (t_p - 1) + \left( \frac{1}{4} - b \right) \frac{p - t_p + a (t_p - 1)}{t_p} \right] \norm*{x^p - x^{p - 1}}_2^2
    .\end{multline}
    Combined with~\zcref{eq:key relation tmp,eq:sum t}, we have
    \begin{align}
        \MoveEqLeft t_{k + 1}^2 \sigma_{k + 1}(z) - \sigma_1(z) \\
        \le{}& - \frac{1}{2 \alpha} \left[ \rho_k(z) - \norm*{x^1 - z}_2^2 \right] \\
             &- \frac{1}{1 - a} \left[ a (t_{k + 1}^2 - t_{k + 1}) + \left( \frac{1}{4} - b \right) k \right] \left[ \sigma_{k + 1}(z) + \frac{1}{2 \alpha} \norm*{x^{k + 1} - x^k}_2^2 \right] \\
             &- \frac{1}{2 \alpha (1 - a)} \sum_{p = 1}^{k} \left[ a^2 (t_p - 1) + \left( \frac{1}{4} - b \right) \frac{p - t_p + a (t_p - 1)}{t_p} \right] \norm*{x^p - x^{p - 1}}_2^2
    .\end{align}
    Easy calculations give
    \begin{multline}
        \frac{1}{1 - a} \left[ t_{k + 1}^2 - a t_{k + 1} + \left( \frac{1}{4} - b \right) k \right] \sigma_{k + 1}(z) \\
        + \frac{1}{2 \alpha (1 - a)} \left[ a (t_{k + 1}^2 - t_{k + 1}) + \left( \frac{1}{4} - b \right) k \right] \norm*{x^{k + 1} - x^k}_2^2 \\
        + \frac{1}{2 \alpha (1 - a)} \sum_{p = 1}^{k} \left[ a^2 (t_p - 1) + \left( \frac{1}{4} - b \right) \frac{p - t_p + a(t_p - 1)}{t_p} \right] \norm*{x^p - x^{p - 1}}_2^2 \\
        + \frac{1}{2 \alpha} \rho_k(z)
        \le \sigma_1(z) + \frac{1}{2 \alpha} \norm*{x^1 - z}_2^2
    .\end{multline}
    \zcref{thm:acc_pgm_fdiff:cur_opt} with~$k = 0$ and~$y^1 = x^0$ and~\zcref{eq:Pythagoras} with~$(v^1, v^2, v^3) = (x^0, x^1, z)$ lead to
    \begin{equation}
        \sigma_1(z) \le - \frac{1}{2 \alpha} \left[ \norm*{x^1 - z}_2^2 - \norm*{x^0 - z}_2^2 \right]
    .\end{equation}
    From the above two inequalities, we can derive the desired inequality.
\end{proof}

Let us define the linear function~$P \colon \setR \to \setR$ and quadratic ones~$Q_1 \colon \setR \to \setR$, and~$Q_2 \colon \setR \to \setR$ by
\begin{equation} \label{eq:P Q}
    \begin{aligned}
    &P(\beta) \coloneqq \frac{a^2 (\beta - 1)}{2},\\
    &Q_1(\beta) \coloneqq \frac{1 - a}{4} \beta^2 + \left[ 1 - \frac{a}{2} + \frac{1 - 4 b}{4 (1 - a)} \right] \beta + 1,\\
    &Q_2(\beta) \coloneqq \frac{a (1 - a)}{4} \beta^2 + \left[ \frac{a}{2} + \frac{1 - 4 b}{4 (1 - a)} \right] \beta
    .\end{aligned}
\end{equation}
The following lemma provides the critical relation to evaluate the convergence rate of \zcref{alg:acc_pgm_MO}.
\begin{lemma} \zlabel{thm:acc conv rate}
    Under \zcref{asm:bound} with~$\Omega \subseteq \setR^n$, \zcref{alg:acc_pgm_MO} generates a sequence~$\set*{x^k}$ such that
    \begin{equation}
        Q_1(k) u_\infty\left(x^{k + 1}\right) + \frac{1}{2 \alpha} Q_2(k) \norm*{x^{k + 1} - x^k}_2^2 + \frac{1}{2 \alpha} \sum_{p = 1}^{k} P(p) \norm*{x^p - x^{p - 1}}_2^2 = O(1)
    \end{equation}
    for all~$k \ge 0$, where~$O \colon [0, +\infty) \to \setR$ satisfies~$\limsup_{t \to \infty} O(t) / t < + \infty$,~$P, Q_1, Q_2 \colon \setR \to \setR$ are given in~\zcref{eq:P Q}, respectively, and~$u_\infty$ is the gap function defined by~\zcref{eq:gap_MO}.
\end{lemma}
\begin{proof}    
    Let~$k \ge 0$.
    With similar arguments used in the proof of \zcref{thm:pgm_rate_convex}, we get
    \begin{equation}
        \sup_{z \in \Omega} \sigma_{k + 1}(z) = u_\infty\left(x^{k + 1}\right)
    .\end{equation} 
    Since~$\rho_k(z) \ge 0$ and~$\Omega$ is bounded, \zcref{thm:key relation} and the above equality lead to
    \begin{multline}
        \frac{1}{1 - a} \left[ t_{k + 1}^2 - a t_{k + 1} + \left( \frac{1}{4} - b \right) k \right] \sigma_{k + 1}(z) \\
        + \frac{1}{2 \alpha (1 - a)} \left[ a (t_{k + 1}^2 - t_{k + 1}) + \left( \frac{1}{4} - b \right) k \right] \norm*{x^{k + 1} - x^k}_2^2 \\
        + \frac{1}{2 \alpha (1 - a)} \sum_{p = 1}^{k} \left[ a^2 (t_p - 1) + \left( \frac{1}{4} - b \right) \frac{p - t_p + a(t_p - 1)}{t_p} \right] \norm*{x^p - x^{p - 1}}_2^2 \\
        + \frac{1}{2 \alpha} \rho_k(z)
        = O(1)
    .\end{multline}
    We now show that the coefficients of the three terms on the right-hand side can be bounded from below by the polynomials given in~\zcref{eq:P Q}.
    First, by using the relation
    \begin{equation} \label{eq:t k+1 geq}
        t_{k + 1} \ge \frac{1 - a}{2} k + 1
    \end{equation} 
    obtained from \zcref{thm:mom_fac:ge} and~$a \in [0, 1)$, we have
    \begin{align}
        \MoveEqLeft \frac{1}{1 - a} \left[ t_{k + 1}^2 - a t_{k + 1} + \left( \frac{1}{4} - b \right) k \right] = \frac{1}{1 - a} \left[ t_{k + 1} (t_{k + 1} - a) + \left( \frac{1}{4} - b \right) k \right] \\
        &\ge \frac{1}{1 - a} \left[ \left( \frac{1 - a}{2} k + 1 \right) \left( \frac{1 - a}{2} k + 1 - a \right) + \left( \frac{1}{4} - b \right) k \right] = Q_1(k)
    .\end{align}
    Again,~\zcref{eq:t k+1 geq} gives
    \begin{align}
        \MoveEqLeft \frac{1}{1 - a} \left[ a (t_{k + 1}^2 - t_{k + 1}) + \left( \frac{1}{4} - b \right) k \right] 
        = \frac{a}{1 - a} t_{k + 1} (t_{k + 1} - 1) + \frac{1 - 4 b}{4 (1 - a)} k \\
        &\ge \frac{a}{1 - a} \left( \frac{1 - a}{2} k + 1 \right) \left( \frac{1 - a}{2} k \right) + \frac{1 - 4 b}{4 (1 - a)} k = Q_2(k)
    .\end{align}
    Moreover, since~$t_p \le p$ (cf.~\zcref{thm:mom_fac:le}),~$t_k \ge 1$ (cf.~\zcref{thm:mom_fac:ge}), and~$b \in (a^2 / 4, 1 / 4]$, we obtain
    \begin{equation}
        \frac{1}{1 - a} \left[ a^2 (t_p - 1) + \left( \frac{1}{4} - b \right) \frac{p - t_p + a (t_p - 1)}{t_p} \right] \ge \frac{a^2}{1 - a} (t_p - 1) \ge P(p)
    .\end{equation} 
    Thus, combining the above equations, we get the desired inequality.
\end{proof}

Then, we can finally prove the main theorem.
\begin{proof}[\zcref{thm:main theomrem of stepsize section:O(1/k2)}]
    It is clear from \zcref{thm:acc conv rate} and~$Q_1(k) = O(k^2)$ as~$k \to \infty$.
\end{proof}
\begin{remark}
    \zcref{thm:acc conv rate} also implies the following other claims than \zcref{thm:main theomrem of stepsize section:O(1/k2)}:
    \begin{itemize}
        \item $O(1 / k^2)$ convergence rate of~$\set*{\norm*{x^{k + 1} - x^k}_2^2}$ when~$a > 0$;
        \item the absolute convergence of~$\set*{k \norm*{x^{k + 1} - x^k}_2^2}$ when~$a > 0$;
    \end{itemize}
    Note that the second one generalizes~\cite[Corollary~3.2]{Chambolle2015} for single-objective problems. 
\end{remark}

\end{document}
